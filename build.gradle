buildscript {
    repositories {
        maven { url 'https://artifactory.int.avast.com/artifactory/maven' }
    }

    dependencies {
        classpath 'com.avast.gradle:gradle-publish:0.11.0'
        classpath 'com.avast.gradle:gradle-release:0.11.0'
        classpath 'com.avast.gradle:gradle-scala:0.11.0'
        classpath 'com.avast.gradle:docker-compose-gradle-plugin:0.3.17'
        classpath 'com.github.maiflai:gradle-scalatest:0.14'
    }
}

apply plugin: 'avast-release'
apply plugin: 'idea'
apply plugin: 'docker-compose'


apply plugin: 'java'
apply plugin: 'avast-publish'
apply plugin: 'avast-scala'
apply plugin: 'com.github.maiflai.scalatest'

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

repositories {
    maven { url 'https://artifactory.int.avast.com/artifactory/maven' }
}

avast {
    publish {
        groupId = 'com.avast.clients'
        artifactId = 'rabbitmq-client'
    }

    scala {
        version = '2.12'
        crossVersions = ['2.11', '2.12']
        versionCatalog = ['2.11': '2.11.8', '2.12': '2.12.1']
    }
}


tasks.withType(ScalaCompile) {
    //noinspection GroovyAccessibility
    scalaCompileOptions.additionalParameters = ['-Xlint', '-Ywarn-value-discard']
}

ext {
    utilsVersion = "4.6.37"
    metricsVersion = "1.11.51"
    bytesVersion = "1.0.9"
}

rootProject.dockerCompose.isRequiredBy(test)

test.doFirst {
    dockerCompose.exposeAsSystemProperties(test)
}

dependencies {
    compile "com.avast.metrics:metrics-api:${metricsVersion}"
    compile 'com.typesafe.scala-logging:scala-logging_?:3.5.0'

    compile "com.avast.utils2:utils-common:${utilsVersion}"
    compile "com.avast.utils2:utils-scala_?:${utilsVersion}"
    compile "com.avast.bytes:bytes-core:${bytesVersion}"

    compile 'com.rabbitmq:amqp-client:4.0.1'
    compile 'com.typesafe:config:1.3.1'
    compile 'com.iheart:ficus_?:1.3.3'

    compile 'com.avast:kluzo-scala_?:1.3.16'
    compile 'com.avast.continuity:continuity-core-scala_?:1.4.18'

    testCompile "com.avast.metrics:metrics-dropwizard:${metricsVersion}"

    testCompile "org.scalaj:scalaj-http_?:2.3.0"
    testCompile 'io.circe:circe-core_?:0.6.1'
    testCompile 'io.circe:circe-generic_?:0.6.1'
    testCompile 'io.circe:circe-parser_?:0.6.1'

    testCompile 'junit:junit:4.12'
    testCompile 'org.scalatest:scalatest_2.11:3.0.0'
    testCompile 'org.mockito:mockito-all:1.10.19'
    testCompile 'ch.qos.logback:logback-classic:1.1.8'

    testRuntime 'org.pegdown:pegdown:1.6.0'
}


allprojects {
    //noinspection UnnecessaryQualifiedReference
    tasks.withType(org.gradle.api.tasks.scala.ScalaDoc) {
        enabled = false
    }
}
